function showAddAnnouncementForm(e){e.preventDefault();$("#material_cancel_button").click();$("#edit_announcement_container").hide();$("#add_announcement_form")[0].reset();$("#add_announcement_container").slideToggle(function(){$("#add_announcement_title").focus();$('[data-toggle="tab"]')[2].click()})}function fillEditAnnouncementForm(e){e.preventDefault();$("#add_announcement_container").hide();$("#edit_announcement_cancel_button").click();$("#material_cancel_button").click();var t=$(this).closest("div").attr("announcement_id");$.post("index.php/announcement/get_announcement",{announcement_id:t},function(e){try{var e=JSON.parse(e)[0];var n=$("#edit_announcement_form");n.find("#edit_announcement_id").val(t);n.find("#edit_announcement_author").val(e.announcement_author);n.find("#edit_announcement_title").val(e.announcement_title);n.find("#edit_announcement_content").val(e.announcement_content);$("#edit_announcement_container").slideToggle();$("#edit_announcement_content").focus()}catch(r){console.log(r);console.log(e)}})}function addAnnouncement(e){e.preventDefault();$.post("index.php/announcement/add",$(this).serialize(),function(e){try{e=JSON.parse(e);generateAnnouncementRow(e,true);$("#announcement_carousel").carousel($(".carousel-inner .item").length-1);$('[data-toggle="tab"]')[2].click()}catch(t){console.log(t);console.log(e)}});$(this).closest("div").hide();this.reset()}function editAnnouncement(e){e.preventDefault();$.post("index.php/announcement/edit",$(this).serialize(),function(e){try{e=JSON.parse(e);var t=$(".carousel-inner").find('.item > div[announcement_id="'+e.announcement_id+'"]');console.log(t);t.find(".announcement_title").text(e.announcement_title);t.find(".announcement_content").text(e.announcement_content);$('[data-toggle="tab"]')[2].click()}catch(n){console.log(n);console.log(e)}});$(this).closest("div").hide();this.reset()}function deleteAnnouncement(e){e.preventDefault();var t=confirm("Confirm deleting this announcement");if(t==true){var n=$(this).closest(".announcement_container");var r=n.attr("announcement_id");$.post("index.php/announcement/delete",{announcement_id:r},function(e){var t=n.closest(".item").addClass("left");var r=t.siblings();$(r[0]).addClass("active");var i=$($(".carousel-indicators li")[t.index()]);console.log("index:"+t.index()+" "+i.siblings());$(i.siblings()[0]).addClass("active");i.remove();t.remove();if($(".carousel-inner .item").length==0)$(".carousel").hide();cancelForm.call(edit_announcement_form)})}}function cancelAnnouncementForm(){var e=$(this);e.closest("div").slideUp(function(){e.closest("form")[0].reset()});return false}$("#announcement_container").ready(function(){$("#add_announcement_button").on("click",showAddAnnouncementForm);$("#add_announcement_cancel_button").on("click",cancelAnnouncementForm);$("#edit_announcement_cancel_button").on("click",cancelAnnouncementForm);$("#add_announcement_form").submit(addAnnouncement);var e=$("#announcements_container");e.on("click",".edit_announcement_button",fillEditAnnouncementForm);e.on("click",".delete_announcement_button",deleteAnnouncement);$("#edit_announcement_form").submit(editAnnouncement);$("#add_announcement_container").hide();$("#edit_announcement_container").hide();$("#add_announcement_button").on("click",function(){$("#add_cancel_button").click();$("#edit_cancel_button").click()});if($(".carousel-inner .item").length==0)$(".carousel").hide()})