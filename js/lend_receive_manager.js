function lendClick(){$this=$(this);$bookno=$this.attr("bookno");$bookauthor=$this.closest("td").find("[book_data = author]").text();$booktitle=$this.closest("td").find("[book_data = book_title]").text();if(confirm("Are you sure you want to lend: \n"+$booktitle+"\n"+$bookno+"\n"+$bookauthor+"?")){$.ajax({url:"book/lend/",data:{id:$bookno},success:function(e){if(e!="0"){var t=$this.attr("reserver");$this.text("Return ("+t+")")}else $this.text("Return");$this.off("click").on("click",receivedClick)}})}else{}}function receivedClick(){var e="";$this=$(this);$bookno=$this.attr("bookno");$bookauthor=$this.closest("td").find("[book_data = author]").text();$booktitle=$this.closest("td").find("[book_data = book_title]").text();if(confirm("Are you sure you want to return: \n"+$booktitle+"\n"+$bookno+"\n"+$bookauthor+"?")){$.ajax({url:"book/received/",data:{id:$bookno},success:function(e){var t=new Array;t[0]=$bookno;$.ajax({url:icejjfish+"/index.php/"+"notifs"+"/"+"check_reserve_for_first",data:{arr:t},type:"POST",dataType:"html",async:true,success:function(e){}});var n=JSON.parse(e);if(n.status==="available"){$this.text("(available)");$this.off("click")}else if(n.status==="reserved"){$.ajax({url:"reserve/get_next/",data:{arr:t},type:"POST",dataType:"html",async:true,success:function(e){$this.text("Lend ("+e+")");$this.off("click").on("click",lendClick);$this.attr("reserver",e)}})}}})}else{}}$(".lendButton").on("click",lendClick);$(".receivedButton").on("click",receivedClick)